<?xml version="1.0" encoding="UTF-8"?>
<fingerprints matches="smb.native_lm" protocol="smb" database_type="service">
  <!--
    SMB fingerprints obtained from the Native LM (LAN manager) field of SMB
    negotations
  -->
  <!-- Mac OS X -->
  <fingerprint pattern="^Samba (3\.0\.28a-apple)$">
    <description>Samba on OS X 10.6</description>
    <example service.version="3.0.28a-apple">Samba 3.0.28a-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.version" value="10.6"/>
    <param pos="0" name="os.cpe23" value="cpe:/o:apple:mac_os_x:10.6"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
    <param pos="0" name="service.cpe23" value="cpe:/a:samba:samba:{service.version}"/>
  </fingerprint>
  <fingerprint pattern="^Samba (3\.0\.25b-apple)$">
    <description>Samba on OS X 10.5</description>
    <example service.version="3.0.25b-apple">Samba 3.0.25b-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.version" value="10.5"/>
    <param pos="0" name="os.cpe23" value="cpe:/o:apple:mac_os_x:10.5"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
    <param pos="0" name="service.cpe23" value="cpe:/a:samba:samba:{service.version}"/>
  </fingerprint>
  <!-- TODO: Detect vendor, distribution, and package versions -->
  <fingerprint pattern="^Samba (\d\.\d+.\d+\w*)">
    <description>Samba</description>
    <example>Samba 3.0.24</example>
    <example>Samba 3.0.28a</example>
    <example>Samba 3.0.32-0.2-2210-SUSE-SL10.3</example>
    <example>Samba 3.6.3</example>
    <example>Samba 3.6.6</example>
    <example>Samba 3.6.9-151.el6_4.1</example>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
    <param pos="0" name="service.cpe23" value="cpe:/a:samba:samba:{service.version}"/>
  </fingerprint>
  <fingerprint pattern="^Netreon LANMAN 1.0$">
    <description>Netreon SAN software</description>
    <example>Netreon LANMAN 1.0</example>
    <param pos="0" name="service.vendor" value="Netreon"/>
  </fingerprint>
  <fingerprint pattern="(?i)^MikrotikSMB$">
    <description>Mikrotik</description>
    <example>MikrotikSMB</example>
    <param pos="0" name="os.vendor" value="MikroTik"/>
    <param pos="0" name="os.device" value="Router"/>
    <param pos="0" name="os.family" value="RouterOS"/>
    <param pos="0" name="os.product" value="RouterOS"/>
    <param pos="0" name="os.cpe23" value="cpe:/o:mikrotik:routeros:-"/>
  </fingerprint>
</fingerprints>
