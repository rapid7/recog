<?xml version="1.0" encoding="UTF-8"?>
<!--
  SMB fingerprints obtained from the Native LM (LAN manager) field of SMB
  negotations
-->
<fingerprints matches="smb.native_lm" protocol="smb" database_type="service">
  <!-- Mac OS X -->
  <fingerprint pattern="^Samba (3\.0\.28a-apple)$">
    <description>Samba on OS X 10.6</description>
    <example service.version="3.0.28a-apple">Samba 3.0.28a-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.device" value="General"/>
    <param pos="0" name="os.version" value="10.6"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
  </fingerprint>
  <fingerprint pattern="^Samba (3\.0\.25b-apple)$">
    <description>Samba on OS X 10.5</description>
    <example service.version="3.0.25b-apple">Samba 3.0.25b-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.device" value="General"/>
    <param pos="0" name="os.version" value="10.5"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
  </fingerprint>
  <!-- TODO: Detect vendor, distribution, and package versions -->
  <fingerprint pattern="^Samba (\d\.\d+.\d+\w*)">
    <description>Samba</description>
    <example>Samba 3.0.24</example>
    <example>Samba 3.0.28a</example>
    <example>Samba 3.0.32-0.2-2210-SUSE-SL10.3</example>
    <example>Samba 3.6.3</example>
    <example>Samba 3.6.6</example>
    <example>Samba 3.6.9-151.el6_4.1</example>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
    <param pos="0" name="service.certainty" value="1.00"/>
  </fingerprint>

  <!-- Windows -->
  <fingerprint pattern="^(Windows [\W*\w*]*)$">
    <description>Windows</description>
    <example service.product="Windows Server 2008 R2 Enterprise 6.1">Windows Server 2008 R2 Enterprise 6.1</example>
    <example service.product="Windows 7 Enterprise 6.1">Windows 7 Enterprise 6.1</example>
    <example service.product="Windows Server 2003 R2 5.2">Windows Server 2003 R2 5.2</example>
    <example service.product="Windows Server 2012 Standard 6.2">Windows Server 2012 Standard 6.2</example>
    <example service.product="Windows 8 Enterprise 6.2">Windows 8 Enterprise 6.2</example>
    <example service.product="Windows Server 2012 R2 Standard 6.3">Windows Server 2012 R2 Standard 6.3</example>
    <param pos="0" name="service.vendor" value="Microsoft"/>
    <param pos="1" name="service.product"/>
    <param pos="0" name="service.certainty" value="1.00"/>
  </fingerprint>

</fingerprints>
